---
- summary: |
    Успешный вход пользователя в систему
  requirement: |
    Пользователь должен иметь возможность зарегистрироваться с корректным e-mail и паролем
  prerequisites: |
    no-data
  test-data: |
    nickname 'TestUserHexlet01'
    email 'testuserhexlet01@example.com'
    password 'StrongP@sswOrd123!'
    confirm_password 'StrongP@sswOrd123!'
  steps:
    - Нажать кнопку 'Зарегистрироваться' (Sign up)
    - Ввести никнейм
    - Ввести e-mail
    - Ввести пароль
    - Подтвердить пароль
    - Нажать кнопку 'Зарегистрироваться' (Submit)
  expected-result: |
     Пользователь успешно авторизован и перенаправлен на главную страницу

- summary: |
    Валидация обязательных полей при регистрации
  requirement: |
    Система должна предотвращать регистрацию и информировать пользователя о необходимости заполнения обязательных полей
  prerequisites: |
    no-data
  test-data: |
    Поле 'Nickname' пустое ('')
    Поле 'Email' пустое ('')
    Поле 'Password' пустое ('')
    Поле 'Password Confirmation' пустое ('')
  steps:
    - Оставить поля 'Nickname', 'Email', 'Password', 'Password Confirmation' пустыми.
    - Нажать кнопку 'Зарегистрироваться' (Submit)
  expected-result: |
    Отображается сообщение об обязательности заполнения полей. Пользователь остается на странице регистрации

- summary: |
    Валидация формата email при регистрации пользователя
  requirement: |
    Система должна проверять формат Email и предотвращать регистрацию с невалидным Email
  prerequisites: |
    no-data
  test-data: |
    nickname 'TestUserInvalidEmail'
    email 'invalid-email-format' или 'test@domain', 'test.com'
    password 'StrongP@sswOrd123!'
    confirm_password 'StrongP@sswOrd123!'
  steps:
    - Ввести никнейм
    - Ввести в Email данные 'invalid-email (или test@domain, test.com)'
    - Ввести пароль
    - Подтвердить пароль
    - Нажать кнопку 'Зарегистрироваться' (Submit)
  expected-result: |
    Регистрация не происходит. Появляется сообщение 'Недопустимый формат e-mail'

- summary: |
    Проверка совпадения паролей при регистрации пользователя
  requirement: |
    Система должна проверять совпадение паролей и предотвращать регистрацию, если они не совпадают
  prerequisites: |
    no-data
  test-data: |
    nickname 'TestUserMismatchPass'
    email 'mismatchpass@example.com'
    password 'StrongP@sswOrd123!'
    confirm_password 'DifferentP@sswOrd456!'
  steps:
    - Нажать кнопку регистрации в правом верхнем углу (Sign up)
    - Ввести никнейм
    - Ввести e-mail
    - Ввести пароль
    - Ввести другой Пароль в поле 'Password Confirmation'
    - Нажать кнопку 'Зарегистрироваться' (Submit)
  expected-result: |
    Регистрация не происходит. Появляется сообщение 'Пароли не совпадают'

- summary: |
    Проверка уникальности email при регистрации пользователя
  requirement: |
    Система должна предотвращать регистрацию с дублирующимся Email
  prerequisites: |
    Существует аккаунт с Email 'existinguser@example.com'
  test-data: |
    nickname 'NewUserExistingEmail'
    email 'existinguser@example.com'
    password 'StrongP@sswOrd123!'
    confirm_password 'StrongP@sswOrd123!'
  steps:
    - Нажать кнопку регистрации в правом верхнем углу (Sign up)
    - Ввести никнейм
    - Ввести e-mail 'existinguser@example.com'
    - Ввести пароль
    - Подтвердить пароль
    - Нажать кнопку 'Зарегистрироваться' (Submit)
  expected-result: |
    Регистрация не происходит. Появляется сообщение 'Email уже используется'

- summary: |
    Проверка уникальности никнейма при регистрации пользователя
  requirement: |
    Система должна предотвращать регистрацию с дублирующимся Никнеймом
  prerequisites: |
    Существует аккаунт с Никнеймом 'ExistingNickname'
  test-data: |
    nickname 'ExistingNickname'
    email 'newemailfornickname@example.com'
    password 'StrongP@sswOrd123!'
    confirm_password 'StrongP@sswOrd123!'
  steps:
    - Нажать кнопку регистрации в правом верхнем углу (Sign up)
    - Ввести Никнейм 'ExistingNickname'
    - Ввести e-mail
    - Ввести пароль
    - Подтвердить пароль
    - Нажать кнопку 'Зарегистрироваться' (Submit)
  expected-result: |
    Регистрация не происходит. Появляется сообщение 'Никнейм уже используется'

- summary: |
    Первичная регистрация через Github
  requirement: |
    Система должна позволять новому пользователю создать учетную запись или авторизоваться, используя существующий аккаунт Github, после предоставления необходимых разрешений приложению
  prerequisites: |
    Отсутствует аккаунт в Codebattle
    Есть активный аккаунт на Github
    Пользователь не авторизован в системе
  test-data: |
    Данные валидного тестового аккаунта Github
  steps:
    - Нажать кнопку регистрации в правом верхнем углу (Sign up)
    - Нажать кнопку 'Sign up with Github'
    - Предоставить приложению необходимые разрешения
  expected-result: |
    Пользователь успешно зарегистрирован. Отправлено письмо для подтверждения email. До подтверждения email доступны только базовые функции. После подтверждения открывается полный доступ

- summary: |
    Первичная регистрация через Discord
  requirement: |
    Пользователь должен иметь возможность зарегистрироваться/войти в систему, используя свой аккаунт Discord
  prerequisites: |
    Отсутствует аккаунт в Codebattle
    Есть активный аккаунт на Discord
    Пользователь не авторизован в системе
  test-data: |
    Данные валидного тестового аккаунта Discord
  steps:
    - Нажать кнопку регистрации в правом верхнем углу (Sign up)
    - Нажать кнопку 'Sign up with Discord'
    - Предоставить приложению необходимые разрешения
  expected-result: |
    Пользователь успешно зарегистрирован. Отправлено письмо для подтверждения email. После подтверждения открывается полный доступ

- summary: |
    Успешный вход существующего пользователя с валидными учетными данными
  requirement: |
    При верном вводе логина и пароля пользователь должен войти в систему
  prerequisites: |
    no-data
  test-data: |
    login_or_email 'ExistingUserLogin'
    password 'ExistingUserP@sswOrd'
  steps:
    - Нажать кнопку авторизации в правом верхнем углу (Sign in)
    - Ввести логин
    - Ввести пароль
    - Нажать кнопку «Войти»
  expected-result: |
     Пользователь успешно авторизован и перенаправлен на главную страницу

- summary: |
    Проверка входа пользователя с несуществующими логином и паролем
  requirement: |
    При неправильном логине или пароле пользователь должен получить сообщение об ошибке
  prerequisites: |
    no-data
  test-data: |
    login_or_email 'NonExistentUser'
    password 'WrongPassword123'
  steps:
    - Нажать кнопку авторизации в правом верхнем углу (Sign in)
    - Ввести неверный логин
    - Ввести неверный пароль
    - Нажать кнопку «Войти»
  expected-result: |
    Появляется сообщение об ошибке 'Неверный логин или пароль'. Пользователь остается на странице входа

- summary: |
    Проверка отправки сообщения в чат Лобби
  requirement: |
    Пользователь должен иметь возможность отправлять сообщения в общий чат в Лобби
  prerequisites: |
    Пользователь зарегистрирован и успешно аутентифицирован в системе
  test-data: |
    no-data
  steps:
    - В поле ввода чата Лобби (внизу слева, 'Be nice in chat!') ввести сообщение
    - Нажать кнопку 'Send' (или Enter)
  expected-result: |
    Сообщение появляется в окне чата Лобби с указанием никнейма отправителя

- summary: |
    Успешное создание новой игры с ботом
  requirement: |
    Зарегистрированный пользователь может создавать игру
  prerequisites: |
    Пользователь зарегистрирован и успешно аутентифицирован в системе
  test-data: |
    level_stars: 2
    game_type_opponent: 'bot'
    time_control_minutes: 5
    task_selection_mode: 'random'
    task_name_or_tag: ''
  steps:
    - Нажать кнопку 'Create a game' (или 'Создать игру')
    - В модальном окне 'Create a game'
        - Выбрать уровень сложности
        - В секции 'Game Type' нажать кнопку 'With a bot'
        - В секции 'Time control' установить время
        - В секции 'Choose task by name or tags' выбрать 'random'
        - Нажать кнопку 'Create battle' (или 'Создать битву')
  expected-result: |
    Создана новая игра с выбранными параметрами, приглашён соперник

- summary: |
    Выбор языка программирования в активной игре
  requirement: |
    Пользователь должен иметь возможность выбрать язык программирования для решения задачи в активной игре
  prerequisites: |
    Пользователь находится в активной игре
  test-data: |
    no-data
  steps:
    - В интерфейсе игры найти выпадающий список выбора языка (слева, под описанием задачи)
    - Кликнуть на список и выбрать желаемый язык программирования
  expected-result: |
    Выбранный язык отображается как активный. Шаблон кода в редакторе пользователя соответствует выбранному языку

- summary: |
    Успешное решение задачи и проверка результата
  requirement: |
    Пользователь должен иметь возможность написать корректное решение задачи, запустить его и увидеть результат
  prerequisites: |
    Пользователь находится в активной игре
    Язык программирования выбран на Python
    Известно корректное решение задачи для выбранного языка
  test-data: |
    # Пример для задачи 'minmax_find' на Python
      def solution(numbers: list[int]) -> list[int]:
          if not numbers:
              return []
          return [min(numbers), max(numbers)]
  steps:
    - В редакторе кода пользователя ввести данные с 'test-data'
    - Нажать кнопку 'Run' (или аналогичную для отправки решения)
  expected-result: |
    Игра завершается. Отображается экран результатов, указывающий на победу

- summary: |
    Приглашения другого пользователя в игру
  requirement: |
    Пользователь может приглашать других пользователей в игру
  prerequisites: |
    Пользователь1 зарегистрирован и аутентифицирован
    Пользователь2 зарегистрирован и аутентифицирован
    Пользователь1 и Пользователь2 не находятся в одной игре
  test-data: |
    no-data
  steps:
    - Пользователь1 нажимает 'CREATE A GAME'
    - В модальном окне выбирает 'With a friend'
    - Пользователь1 вводит 'Никнейм' Пользователь2
    - Пользователь1 нажимает 'Create battle'
  expected-result: |
    Отправляется приглашение User2. В лобби появляется уведомление 'You invited (Никнейм приглашенного пользователя)'

- summary: |
    Редактирования задачи двумя игроками в реальном времени
  requirement: |
    Система должна обеспечивать одновременное редактирование задачи для двух игроков с отображением кода соперника в реальном времени
  prerequisites: |
    Два пользователя в одной игре, задача открыта
  test-data: |
    no-data
  steps:
    - Игрок1 вносит изменение в свой редактор
    - Игрок2 наблюдает изменение кода соперника
    - Игрок2 вносит изменение в свой редактор
    - Игрок1 наблюдает изменение кода соперника
  expected-result: |
    В обоих редакторах в реальном времени отображаются изменения кода соперника

- summary: |
    Создание игры с выбором задачи по тегу
  requirement: |
    Пользователь может создать игру, выбрав задачу по определенному тегу
  prerequisites: |
    no-data
  test-data: |
    level_stars: 1
    game_type_opponent: 'bot'
    task_tag: 'math'
  steps:
    - Нажать 'CREATE A GAME'
    - Выбрать Level '1'(elementary)
    - Выбрать Game Type 'bot'
    - В секции "Choose task by name or tags" кликнуть на тег 'math'
    - Из отфильтрованного списка выбрать конкретную задачу или оставить выбор случайной по тегу
    - Нажать 'Create battle'
  expected-result: |
    Пользователь перенаправлен в игровую комнату с задачей соответсвующей выброному тегу

- summary: |
    Отображение результата после окончания игры
  requirement: |
    После окончания игры отображается результат
  prerequisites: |
    Пользователь завершил игру (например, сдал задачу или время истекло)
  test-data: |
    no-data
  steps:
    - Завершить игру (правильно решить задачу или дождаться окончания времени)
  expected-result: |
    На экране отображается результат игры (например 'победа', 'поражение')

- summary: |
    Просмотр собственного профиля пользователя
  requirement: |
    Пользователь должен иметь возможность просмотреть свой профиль со статистикой
  prerequisites: |
    no-data
  test-data: |
    no-data
  steps:
    - Кликнуть на свой никнейм/аватар в правом верхнем углу
    - В выпадающем меню выбрать 'My Profile'
  expected-result: |
    Пользователь перенаправлен на страницу своего профиля. На странице отображаются: никнейм, аватар, ранг (rank), elo_rating, количество сыгранных игр (games_played), статистика побед/поражений (won/lost/gaveUp), график активности

- summary: |
    Изменение настроек пользователя
  requirement: |
    Пользователь должен иметь возможность изменять и сохранять настройки своего профиля
  prerequisites: |
    no-data
  test-data: |
    no-data
  steps:
    - Кликнуть на свой никнейм/аватар в правом верхнем углу
    - В выпадающем меню выбрать 'Settings'
    - На странице 'Settings' в поле "Your weapon" выбрать (например JavaScript) из выпадающего списка
    - Нажать кнопку 'Save'
  expected-result: |
    Отображается сообщение об успешном сохранении. При повторном открытии страницы 'Settings' в поле "Your weapon"(или любом измененном) отображается выбранный параметр

- summary: |
    Просмотр общего лидерборда пользователей
  requirement: |
    Пользователь должен иметь возможность просмотреть страницу с рейтингом всех пользователей
  prerequisites: |
    no-data
  test-data: |
    no-data
  steps:
    - Кликнуть на свой никнейм/аватар в правом верхнем углу
    - В выпадающем меню выбрать 'Users rating'
  expected-result: |
    Пользователь перенаправлен на страницу 'Users rating'. Отображается таблица с пользователями, включающая колонки: #, User, Rank, Rating, Games played, Joined, Github (статус привязки)

- summary: |
    Просмотр списка доступных и завершенных турниров
  requirement: |
    Пользователь должен иметь возможность просмотреть списки активных/ожидающих и завершенных турниров
  prerequisites: |
    no-data
  test-data: |
    no-data
  steps:
    - Кликнуть на свой никнейм/аватар в правом верхнем углу
    - В выпадающем меню выбрать 'Tournaments'
  expected-result: |
    Пользователь перенаправлен на страницу турниров. Для каждого турнира отображаются: Name, Type, Level, State, Starts_at, Actions (кнопка 'Show')

- summary: |
    Создание нового индивидуального турнира
  requirement: |
    Пользователь должен иметь возможность создать новый индивидуальный турнир
  prerequisites: |
    Пользователь зарегистрирован и аутентифицирован
    Пользователь находится на странице 'Tournaments'
  test-data: |
    tournament_name: 'My Test Tournament'
    tournament_type: 'individual'
    description: 'Test tournament created by automated test'
    start_date: (выбрать ближайшую доступную дату/время из календаря)
    access_type: 'public'
    task_strategy: 'random_per_game'
    score_strategy: 'time_and_tests'
    use_chat: true
    use_timer: true
    task_provider: 'level'
    level: 'easy'
    event: '' (оставить пустым, если не обязательно)
    players_limit: 2 (Значения по умолчанию или минимальные)
    timeout_seconds: 175 (Значения по умолчанию или типичные)
    break_duration_seconds: 42
  steps:
    - На странице 'Tournaments' заполнить форму "Create a new tournament" данными из `test-data`
    - Нажать кнопку 'Create'
  expected-result: |
    Турнир успешно создан. Новый турнир появляется в списке 'Live tournaments' с указанными параметрами
